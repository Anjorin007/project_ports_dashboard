{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-07T15:01:51.733941Z", "invocation_id": "a211f5bc-f5a3-401e-8b79-52c8813d6297", "invocation_started_at": "2025-12-07T15:01:47.866245Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T15:01:50.288531Z", "completed_at": "2025-12-07T15:01:50.334443Z"}, {"name": "execute", "started_at": "2025-12-07T15:01:50.336444Z", "completed_at": "2025-12-07T15:01:50.546546Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2630159854888916, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.ports_dashboard.stg_dim_port", "compiled": true, "compiled_code": "\n\nselect\n    port_id,\n    port_code,\n    port_name,\n    country,\n    region,\n    created_at\nfrom \"ports_dashboard\".\"public\".\"dim_port\"\nwhere port_id is not null", "relation_name": "\"ports_dashboard\".\"public_staging\".\"stg_dim_port\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T15:01:50.567859Z", "completed_at": "2025-12-07T15:01:50.581932Z"}, {"name": "execute", "started_at": "2025-12-07T15:01:50.583932Z", "completed_at": "2025-12-07T15:01:50.807698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.24583792686462402, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.ports_dashboard.stg_dim_quality_flag", "compiled": true, "compiled_code": "\n\nselect\n    flag_id,\n    flag_name,\n    flag_description,\n    severity\nfrom \"ports_dashboard\".\"public\".\"dim_quality_flag\"\nwhere flag_id is not null", "relation_name": "\"ports_dashboard\".\"public_staging\".\"stg_dim_quality_flag\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T15:01:50.835221Z", "completed_at": "2025-12-07T15:01:50.855540Z"}, {"name": "execute", "started_at": "2025-12-07T15:01:50.857540Z", "completed_at": "2025-12-07T15:01:50.981609Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15238595008850098, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.ports_dashboard.stg_port_traffic", "compiled": true, "compiled_code": "-- ============================================================================\n-- FILE: models/staging/stg_port_traffic.sql\n-- ============================================================================\n\n\n\nwith source_data as (\n    select\n        traffic_id,\n        port_id,\n        quality_flag_id,\n        year,\n        quarter,\n        tonnage_mt,\n        imports_mt,\n        exports_mt,\n        teus,\n        num_vessels,\n        data_source,\n        source_url,\n        has_tonnage,\n        has_teus,\n        analysis_note,\n        extraction_date,\n        data_notes,\n        clean_date,\n        created_at,\n        updated_at\n    from \"ports_dashboard\".\"public\".\"fact_port_traffic\"\n    where port_id is not null\n        and year is not null\n),\n\nenriched as (\n    select\n        traffic_id,\n        port_id,\n        quality_flag_id,\n        year,\n        quarter,\n        coalesce(tonnage_mt, 0) as tonnage_mt,\n        coalesce(imports_mt, 0) as imports_mt,\n        coalesce(exports_mt, 0) as exports_mt,\n        coalesce(teus, 0) as teus,\n        coalesce(num_vessels, 0) as num_vessels,\n        data_source,\n        source_url,\n        has_tonnage,\n        has_teus,\n        analysis_note,\n        extraction_date,\n        data_notes,\n        clean_date,\n        created_at,\n        updated_at,\n        case \n            when quarter is not null then 'Q' || quarter\n            else 'ANNUAL'\n        end as period_type,\n        case \n            when has_tonnage and has_teus then 'BOTH_INDICATORS'\n            when has_tonnage then 'TONNAGE_ONLY'\n            when has_teus then 'TEU_ONLY'\n            else 'NO_DATA'\n        end as indicator_type\n    from source_data\n)\n\nselect * from enriched", "relation_name": "\"ports_dashboard\".\"public_staging\".\"stg_port_traffic\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T15:01:50.998232Z", "completed_at": "2025-12-07T15:01:51.017853Z"}, {"name": "execute", "started_at": "2025-12-07T15:01:51.019853Z", "completed_at": "2025-12-07T15:01:51.176776Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.18454194068908691, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.ports_dashboard.mart_port_annual_summary", "compiled": true, "compiled_code": "\n\nwith traffic_data as (\n    select\n        port_id,\n        year,\n        tonnage_mt,\n        teus,\n        num_vessels,\n        has_tonnage,\n        has_teus,\n        quality_flag_id\n    from \"ports_dashboard\".\"public_staging\".\"stg_port_traffic\"\n),\n\nport_info as (\n    select * from \"ports_dashboard\".\"public_staging\".\"stg_dim_port\"\n),\n\nannual_stats as (\n    select\n        t.port_id,\n        p.port_code,\n        p.port_name,\n        p.country,\n        t.year,\n        sum(t.tonnage_mt) as total_tonnage_mt,\n        avg(t.tonnage_mt) as avg_tonnage_mt,\n        sum(t.teus) as total_teus,\n        sum(t.num_vessels) as total_vessels,\n        count(*) as num_records,\n        sum(case when t.has_tonnage then 1 else 0 end) as records_with_tonnage,\n        sum(case when t.has_teus then 1 else 0 end) as records_with_teus,\n        current_timestamp as created_at\n    from traffic_data t\n    join port_info p on t.port_id = p.port_id\n    group by t.port_id, p.port_code, p.port_name, p.country, t.year\n)\n\nselect * from annual_stats", "relation_name": "\"ports_dashboard\".\"public_marts\".\"mart_port_annual_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T15:01:51.191498Z", "completed_at": "2025-12-07T15:01:51.200478Z"}, {"name": "execute", "started_at": "2025-12-07T15:01:51.202986Z", "completed_at": "2025-12-07T15:01:51.338401Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.152540922164917, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.ports_dashboard.mart_data_quality", "compiled": true, "compiled_code": "\n\nselect\n    port_code,\n    port_name,\n    country,\n    year,\n    records_with_tonnage,\n    records_with_teus,\n    num_records,\n    round(100.0 * records_with_tonnage / nullif(num_records, 0), 2) as tonnage_coverage_pct,\n    round(100.0 * records_with_teus / nullif(num_records, 0), 2) as teu_coverage_pct,\n    case\n        when records_with_tonnage > 0 then 'HIGH'\n        when records_with_teus > 0 then 'MEDIUM'\n        else 'LOW'\n    end as quality_level\nfrom \"ports_dashboard\".\"public_marts\".\"mart_port_annual_summary\"\norder by port_code, year", "relation_name": "\"ports_dashboard\".\"public_marts\".\"mart_data_quality\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T15:01:51.363877Z", "completed_at": "2025-12-07T15:01:51.379483Z"}, {"name": "execute", "started_at": "2025-12-07T15:01:51.381483Z", "completed_at": "2025-12-07T15:01:51.533615Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.17574095726013184, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.ports_dashboard.mart_port_comparison", "compiled": true, "compiled_code": "\n\nwith latest_year_data as (\n    select\n        port_id,\n        port_code,\n        port_name,\n        country,\n        year,\n        total_tonnage_mt,\n        total_teus\n    from \"ports_dashboard\".\"public_marts\".\"mart_port_annual_summary\"\n    where year = (select max(year) from \"ports_dashboard\".\"public_marts\".\"mart_port_annual_summary\")\n),\n\nmarket_share as (\n    select\n        port_code,\n        port_name,\n        country,\n        year,\n        total_tonnage_mt,\n        total_teus,\n        round(100.0 * total_tonnage_mt / nullif(sum(total_tonnage_mt) over (), 0), 2) as tonnage_market_share_pct,\n        round(100.0 * total_teus / nullif(sum(total_teus) over (), 0), 2) as teu_market_share_pct,\n        rank() over (order by total_tonnage_mt desc) as tonnage_rank,\n        rank() over (order by total_teus desc) as teu_rank\n    from latest_year_data\n)\n\nselect * from market_share\norder by tonnage_rank", "relation_name": "\"ports_dashboard\".\"public_marts\".\"mart_port_comparison\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T15:01:51.548341Z", "completed_at": "2025-12-07T15:01:51.558002Z"}, {"name": "execute", "started_at": "2025-12-07T15:01:51.560008Z", "completed_at": "2025-12-07T15:01:51.672897Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12953901290893555, "adapter_response": {"_message": "SELECT 9", "code": "SELECT", "rows_affected": 9}, "message": "SELECT 9", "failures": null, "unique_id": "model.ports_dashboard.mart_port_trends", "compiled": true, "compiled_code": "\n\nwith annual_data as (\n    select\n        port_code,\n        port_name,\n        country,\n        year,\n        total_tonnage_mt,\n        total_teus\n    from \"ports_dashboard\".\"public_marts\".\"mart_port_annual_summary\"\n),\n\nwith_lag as (\n    select\n        port_code,\n        port_name,\n        country,\n        year,\n        total_tonnage_mt,\n        total_teus,\n        lag(total_tonnage_mt) over (partition by port_code order by year) as prev_tonnage_mt,\n        lag(total_teus) over (partition by port_code order by year) as prev_teus,\n        round(100.0 * (total_tonnage_mt - lag(total_tonnage_mt) over (partition by port_code order by year)) / nullif(lag(total_tonnage_mt) over (partition by port_code order by year), 0), 2) as tonnage_yoy_pct,\n        round(100.0 * (total_teus - lag(total_teus) over (partition by port_code order by year)) / nullif(lag(total_teus) over (partition by port_code order by year), 0), 2) as teu_yoy_pct\n    from annual_data\n)\n\nselect\n    port_code,\n    port_name,\n    country,\n    year,\n    total_tonnage_mt,\n    tonnage_yoy_pct,\n    total_teus,\n    teu_yoy_pct,\n    current_timestamp as created_at\nfrom with_lag\nwhere year > 2020\norder by port_code, year", "relation_name": "\"ports_dashboard\".\"public_marts\".\"mart_port_trends\"", "batch_results": null}], "elapsed_time": 1.982943058013916, "args": {"invocation_command": "dbt run", "require_resource_names_without_spaces": true, "select": [], "strict_mode": false, "require_yaml_configuration_for_mf_time_spines": false, "require_generic_test_arguments_property": true, "log_level": "info", "log_level_file": "debug", "validate_macro_args": false, "favor_state": false, "require_nested_cumulative_type_params": false, "exclude": [], "quiet": false, "use_colors": true, "which": "run", "profiles_dir": "C:\\Users\\DELL\\Desktop\\project_ports_dashboard\\dbt_project", "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse_file_diff": true, "log_file_max_bytes": 10485760, "write_json": true, "project_dir": "C:\\Users\\DELL\\Desktop\\project_ports_dashboard\\dbt_project", "show_resource_report": false, "print": true, "upload_to_artifacts_ingest_api": false, "use_colors_file": true, "log_format_file": "debug", "state_modified_compare_more_unrendered_values": false, "populate_cache": true, "source_freshness_run_project_hooks": true, "require_batched_execution_for_custom_microbatch_strategy": false, "vars": {}, "state_modified_compare_vars": false, "use_fast_test_edges": false, "empty": false, "indirect_selection": "eager", "skip_nodes_if_on_run_start_fails": false, "introspect": true, "defer": false, "macro_debugging": false, "require_all_warnings_handled_by_warn_error": false, "static_parser": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "send_anonymous_usage_stats": true, "show_all_deprecations": false, "log_path": "C:\\Users\\DELL\\Desktop\\project_ports_dashboard\\dbt_project\\logs", "version_check": true, "log_format": "default", "printer_width": 80, "partial_parse": true, "cache_selected_only": false}}